<?xml version="1.0" encoding="UTF-8"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://chartConfigView.title">

    <actions>
        <action id="closeAction" type="view_close"/>
    </actions>

    <!-- ðŸ”¹ GLOBAL LAYOUT -->
    <layout css="padding: 24px; background-color: #f4f6f8; gap: 20px; height: 100%;">

        <!-- ðŸ”¹ HEADER -->
        <vbox width="100%" css="background-color: #ffffff; padding: 16px 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
            <hbox spacing="true" css="gap: 40px; align-items: center;">
                <hbox css="gap: 8px; align-items: center;">
                    <icon icon="DATABASE" css="color: var(--lumo-primary-color); width: 18px; height: 18px;"/>
                    <nativeLabel text="Dataset:" css="font-weight: 600; color: var(--lumo-secondary-text-color); font-size: 0.9em;"/>
                    <nativeLabel id="datasetNameLabel" css="font-weight: 600; color: var(--lumo-header-text-color); font-size: 1.1em;"/>
                </hbox>

                <hbox css="gap: 8px; align-items: center;">
                    <icon icon="BAR_CHART" css="color: var(--lumo-primary-color); width: 18px; height: 18px;"/>
                    <nativeLabel text="Chart type:" css="font-weight: 600; color: var(--lumo-secondary-text-color); font-size: 0.9em;"/>
                    <nativeLabel id="chartTypeLabel" css="font-weight: 600; color: var(--lumo-header-text-color); font-size: 1.1em;"/>
                </hbox>
            </hbox>
        </vbox>

        <!-- ðŸ”¹ TOOLBAR: Input dÃ£n rá»™ng tá»‘i Ä‘a -->
        <hbox width="40%" height="100px" css="align-items: center; gap: 16px;">
            <!-- ÄÃ£ thay Ä‘á»•i: width="100%" vÃ  thÃªm flex-grow Ä‘á»ƒ input dÃ i ra -->
            <textField id="chartNameField"
                       placeholder="Nháº­p tÃªn biá»ƒu Ä‘á»“..."
                       height="50px"
                       css="flex-grow: 1; font-size: 18px; --lumo-text-field-size: 50px;"
                       helperText="TÃªn hiá»ƒn thá»‹ trÃªn dashboard">
                <prefix>
                    <icon icon="PENCIL" css="width: 20px; height: 20px;"/>
                </prefix>
            </textField>

            <button id="save"
                    text="LÆ°u cáº¥u hÃ¬nh"
                    icon="CHECK"
                    height="50px"
                    themeNames="primary"
                    css="border-radius: 8px; padding: 0 32px; font-size: 16px; font-weight: 600; box-shadow: 0 4px 6px rgba(var(--lumo-primary-color-rgb), 0.3); flex-shrink: 0;"/>
        </hbox>

        <!-- ðŸ”¹ MAIN CONTENT -->
        <hbox width="100%" height="100%" css="gap: 20px; align-items: stretch;">

            <!-- ðŸ”¸ LEFT PANE: Fields List (TÄƒng lÃªn 25%) -->
            <vbox width="25%"
                  css="background-color: #ffffff; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.06); padding: 16px; border: 1px solid rgba(0,0,0,0.05);">

                <hbox css="align-items: center; gap: 8px; margin-bottom: 8px;">
                    <icon icon="LIST" css="color: var(--lumo-secondary-text-color); width: 16px;"/>
                    <nativeLabel text="Danh sÃ¡ch trÆ°á»ng" css="font-weight: 700; color: var(--lumo-header-text-color); font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;"/>
                </hbox>

                <nativeLabel text="KÃ©o tháº£ vÃ o trá»¥c X/Y" css="font-size: 30px; color: var(--lumo-secondary-text-color); margin-bottom: -10px;"/>

                <vbox id="fieldsList"
                      width="100%"
                      height="100%"
                      css="overflow-y: auto; gap: 8px; padding-right: 4px;"/>
            </vbox>

            <!-- ðŸ”¸ MIDDLE PANE: Configuration (Giá»¯ nguyÃªn 25%) -->
            <vbox width="25%"
                  css="background-color: #ffffff; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.06); padding: 20px; border: 1px solid rgba(0,0,0,0.05);">

                <hbox css="align-items: center; gap: 8px; margin-bottom: 16px; border-bottom: 1px solid var(--lumo-contrast-10pct); padding-bottom: 12px;">
                    <icon icon="COG" css="color: var(--lumo-secondary-text-color);"/>
                    <nativeLabel text="Cáº¥u hÃ¬nh trá»¥c" css="font-weight: 700; color: var(--lumo-header-text-color); font-size: 16px;"/>
                </hbox>

                <vbox id="configContainer" width="100%" css="gap: 16px; flex-grow: 1;">
                    <fragment id="barConfig"
                              class="com.company.chartconfig.view.barconfigfragment.BarConfigFragment"/>

                    <fragment id="pieConfig"
                              class="com.company.chartconfig.view.pieconfigfragment.PieConfigFragment"/>
                </vbox>

                <vbox width="100%" css="gap: 10px; margin-top: auto; padding-top: 20px; border-top: 1px solid var(--lumo-contrast-10pct);">
                    <button id="previewBtn"
                            text="Xem trÆ°á»›c (Preview)"
                            width="100%"
                            themeNames="primary outlined"
                            css="border-radius: 8px;"/>
                    <button id="closeBtn"
                            action="closeAction"
                            text="Há»§y bá»"
                            width="100%"
                            themeNames="tertiary error"
                            css="border-radius: 8px;"/>
                </vbox>
            </vbox>

            <!-- ðŸ”¸ RIGHT PANE: Preview Area (Giáº£m xuá»‘ng 50%) -->
            <vbox width="50%"
                  css="background-color: #ffffff; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 24px; border: 1px solid rgba(0,0,0,0.05);">

                <hbox css="justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <nativeLabel text="Biá»ƒu Ä‘á»“ hiá»ƒn thá»‹" css="font-weight: 700; color: var(--lumo-header-text-color); font-size: 18px;"/>
                    <span css="background: var(--lumo-contrast-5pct); padding: 4px 12px; border-radius: 20px; color: var(--lumo-secondary-text-color); font-size: 12px;">Live Preview</span>
                </hbox>

                <vbox id="chartContainer"
                      width="100%"
                      height="100%"
                      css="background-color: #fafafa; border-radius: 8px; border: 1px dashed #d0d0d0; justify-content: center; align-items: center; overflow: hidden;"/>
            </vbox>

        </hbox>
    </layout>
</view>